
# 실행 방법
```
// 프로젝트를 클론합니다.
$ git clone https://github.com/kyhong222/nexon-recruit

// 클론된 폴더로 이동합니다.
$ cd nexon-recruit

// docker compose 명령어를 사용하여 프로젝트를 가동합니다.
// gateway endpoint는 localhost:3002입니다.
$ docker compose up -d --build

// docker compose 명령어를 사용하여 프로젝트를 종료합니다.
$ docker compose down
```

# API 문서
## document(with postman)
https://documenter.getpostman.com/view/1305674/2sB2qXmiik

# 구성
본 프로젝트 구성은 크게 3개의 서버로 이루어져 있습니다.
## auth-server
- 인증 및 JWT 관리 담당
- gateway에서 auth로 로그인을 시도하면, jwt를 response함
- gateway는 이때 받은 jwt를 바탕으로 gateway 내 호출시 인증함.
## event-server
- 이벤트 및 보상을 관리하는 서버
- 이벤트, 보상테이블, 보상테이블의 아이템, 이벤트 성공 조건 4가지 모델을 다룸
## gateway-server
- 메인 인입점
- 사실상 메인 게임서버로 인식하였고, 여기서 회원가입, 로그인, 액션(몬스터 죽이기, 인벤토리 열기 등) 등 메이플스토리를 모티브로 하여 기능을 집어넣었음.
---
# 설계 및 구현
## 이벤트 설계
현재 메이플스토리의 이벤트/보상 체계를 분석하여 4가지 모델을 정의하였습니다.
- 이벤트(event)
  - 가장 큰 단위
  - 복수의 보상 테이블을 가질 수 있음
  - 복수의 성공 조건을 가질 수 있음
- 보상테이블(reward)
  - 이벤트 성공시 유저에게 제공하는 아이템의 집합
  - 같은 이벤트라도 다른 보상이 주어질 것을 염두하고 설계하였음
- 아이템(item)
  - 보상테이블을 이루는 가장 작은 단위
- 이벤트 성공 조건(condition)
  - 이벤트 성공 조건을 검증하기 위함
    - '몬스터 n마리 사냥'
    - 'n회 이상 접속'
    - '다른 이벤트 성공' 등을 구현해 두었음
  - 기획파트에서 새로운 성공 조건을 기획할때마다 추가구현해야하는 단점이 있지만, 미리 만들어 놓은 조건을 사용하여 운영팀에서 자체적으로 이벤트를 시행할 수 있을것으로 예상됨

제가 가장 고민한 부분은 '이벤트의 조건을 어떻게 검증할 것인가?' 였습니다.
이벤트를 진행하다보면 대부분 정형화된 기획으로 진행되어 조건의 경우의 수(몬스터 N마리 사냥, 출석체크 등)를 한정할 수 있지만, 게임은 엔터테인먼트 산업이므로 언제든 새로운 기획에 대응할 수 있어야 합니다.

그와 동시에 이벤트를 진행할 때 마다 개발 소요가 최소한으로 발생하도록 해야합니다.
그렇기 때문에 이미 진행한 적 있는 조건들을 템플릿으로 개발해 두고, 개발된 조건들로 기획이 커버되지 않을때 추가적으로 개발하는 방식이 합리적이라고 생각하였습니다.

## 이벤트 생성

이벤트 생성은
  1. 아이템 생성
  2. 보상테이블 구성
  3. 이벤트 성공 조건 구성
  4. 이벤트 생성

순서로 진행해야 합니다.

보상테이블과 이벤트 생성은 operator가 진행할 수 있어야 하기 때문에 이벤트 성공 조건 생성과 함께 권한을 주었지만, 아이템 생성 권한 admin으로 제한하였습니다.

실제 필드에서는 미리 생성된 아이템을 바탕으로 보상테이블을 구성할 것으로 예상됩니다.

## JWT
사용자는 gateway-server를 통해 auth-server로 로그인 요청을 보내게 됩니다.
auth-server는 입력을 바탕으로 계정정보를 JWT에 담아 응답합니다.
클라이언트는 받아온 JWT를 사용하여 gateway-server의 엔드포인트를 호출할 때 인증을 진행하며, gateway-server의 모든 엔드포인트는 Rolesguard가 적용되어 있어 권한 이외의 엔드포인트를 호출하지 못합니다.


# 참고자료
## Postman
https://web.postman.co/workspace/911efad0-7de3-4d33-8902-e510a6342d94

위 링크를 통해 postman에 접속하신 뒤 nexon-recruit 컬렉션에서 api 테스트가 가능할것 같습니다...

## Notion
https://www.notion.so/1f6e3a72817880a88748fc2eb309ee1d?pvs=4

과제 안내문을 읽으면서 기획안을 분석하듯 분석해보았습니다. 실제 개발된 결과물과 약간 차이는 있지만, 거의 그대로 따랐습니다.

---